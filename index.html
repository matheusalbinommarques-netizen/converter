<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Conversor de Arquivos Universal - MVP</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: #0f172a;
        color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
      }
      .card {
        background: #1f2937;
        padding: 24px 32px;
        border-radius: 16px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        text-align: center;
        max-width: 520px;
      }
      h1 {
        margin: 0 0 8px;
        font-size: 1.8rem;
      }
      h2 {
        margin: 0 0 4px;
        font-size: 1rem;
        font-weight: 500;
        opacity: 0.9;
      }
      p {
        margin: 4px 0;
        opacity: 0.85;
      }
      .tag {
        display: inline-block;
        margin-top: 12px;
        padding: 4px 10px;
        border-radius: 999px;
        background: #10b98122;
        border: 1px solid #10b981;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.06em;
      }
      .actions {
        margin-top: 20px;
        display: flex;
        gap: 12px;
        justify-content: center;
        flex-wrap: wrap;
      }
      button {
        border: none;
        padding: 10px 16px;
        border-radius: 999px;
        font-size: 0.9rem;
        cursor: pointer;
        font-weight: 500;
        background: #22c55e;
        color: #022c22;
        box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        transition: transform 0.08s ease, box-shadow 0.08s ease, opacity 0.08s ease;
      }
      button.secondary {
        background: #111827;
        color: #e5e7eb;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
      }
      button.ghost {
        background: transparent;
        border: 1px solid #4b5563;
        color: #e5e7eb;
        box-shadow: none;
      }
      button:disabled {
        opacity: 0.6;
        cursor: default;
        box-shadow: none;
        transform: none;
      }
      button:hover:not(:disabled) {
        transform: translateY(-1px);
        box-shadow: 0 14px 30px rgba(16, 185, 129, 0.4);
      }
      button.secondary:hover:not(:disabled) {
        box-shadow: 0 14px 30px rgba(0, 0, 0, 0.8);
      }
      button.ghost:hover:not(:disabled) {
        box-shadow: none;
        background: rgba(15, 23, 42, 0.8);
      }
      #status {
        margin-top: 16px;
        font-size: 0.9rem;
        min-height: 1.4em;
        word-break: break-all;
      }
      #status.ok {
        color: #22c55e;
      }
      #status.error {
        color: #f97373;
      }
      #status.info {
        color: #e5e7eb;
      }
      .path {
        font-size: 0.8rem;
        opacity: 0.8;
        margin-top: 4px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Conversor de Arquivos Universal</h1>
      <h2>MVP Desktop – Imagem para JPG</h2>
      <p>Selecione uma imagem PNG/JPG, converta e abra a pasta do resultado.</p>

      <div class="tag">imagem → jpg</div>

      <div class="actions">
        <button id="select-file">Escolher imagem</button>
        <button id="convert-btn" class="secondary" disabled>
          Converter para JPG
        </button>
        <button id="open-folder-btn" class="ghost" disabled>
          Abrir pasta do arquivo
        </button>
      </div>

      <div id="status" class="info"></div>
      <div id="selected-path" class="path"></div>
    </div>

    <script>
      const selectBtn = document.getElementById('select-file');
      const convertBtn = document.getElementById('convert-btn');
      const openFolderBtn = document.getElementById('open-folder-btn');
      const statusEl = document.getElementById('status');
      const selectedPathEl = document.getElementById('selected-path');

      let selectedPath = null;
      let lastOutputPath = null;

      function setStatus(message, type = 'info') {
        statusEl.textContent = message;
        statusEl.className = type;
      }

      selectBtn.addEventListener('click', async () => {
        setStatus('Abrindo seletor de arquivos...', 'info');
        selectedPathEl.textContent = '';
        lastOutputPath = null;
        openFolderBtn.disabled = true;

        try {
          const filePath = await window.api.selectImage();

          if (!filePath) {
            setStatus('Nenhum arquivo selecionado.', 'info');
            selectedPath = null;
            convertBtn.disabled = true;
            return;
          }

          selectedPath = filePath;
          selectedPathEl.textContent = 'Arquivo selecionado: ' + filePath;
          setStatus('Pronto para converter.', 'ok');
          convertBtn.disabled = false;
        } catch (err) {
          console.error(err);
          setStatus('Erro ao selecionar arquivo.', 'error');
          selectedPath = null;
          convertBtn.disabled = true;
        }
      });

      convertBtn.addEventListener('click', async () => {
        if (!selectedPath) {
          setStatus('Selecione um arquivo primeiro.', 'error');
          return;
        }

        setStatus('Convertendo arquivo...', 'info');
        convertBtn.disabled = true;
        openFolderBtn.disabled = true;
        lastOutputPath = null;

        try {
          const outputPath = await window.api.convertImage(selectedPath);
          lastOutputPath = outputPath;
          setStatus('Conversão concluída com sucesso!', 'ok');
          selectedPathEl.textContent =
            'Arquivo gerado em: ' + outputPath;
          openFolderBtn.disabled = false;
        } catch (err) {
          console.error(err);
          setStatus('Erro na conversão: ' + err.message, 'error');
        } finally {
          convertBtn.disabled = false;
        }
      });

      openFolderBtn.addEventListener('click', async () => {
        if (!lastOutputPath) {
          setStatus('Não há arquivo gerado para abrir.', 'error');
          return;
        }

        try {
          await window.api.openInFolder(lastOutputPath);
        } catch (err) {
          console.error(err);
          setStatus('Erro ao abrir a pasta.', 'error');
        }
      });
    </script>
  </body>
</html>
